단순하게 몇 개정도의 차원으로 이루어진 데이터에 대해서는 FCN(Fully Connected Network) 구조의 딥러닝 학습이 기존의 통계방법이나 다른 머신러닝 방법 만큼이나 잘 학습이 됨  
그런데 이미지 인식이나 음성 자연어 인식과 같은 작업을 위해서는 훨씬더 복잡한 데이터의 특징을 잡아내야함  

이를 위해서 보다 효율적이고 효과적인 구조가 필요함 
이번 토픽에서 각 데이터 종류별로 특성에 최적화된 뉴럴 네트워크 구조가 필요를 알아보자  

- CNN : 이미지 데이터 특징에 최적화 
- RNN : 시계열 데이터 특징에 최적화 ex)) 주가 데이터, 센서 데이터 등 순서가 있는 데이터 
- AutoEncoder : 차원 축소에 유용 ex) 고차원 데이터의 차원축소에 유용, 생성형 모델이나 언어모델과 같은 응용에 사용됨 


## CNN이란? 

CNN : Convolutional Neural Network 

고양이와 강아지 모델을 구별하는 딥러닝 모델을 만든다고 하자 

1-47
우선 이미지 데이터를 컴퓨터가 인식할 수 있는 형태로 표현하는데 
기본적으로 **비트맵**이라는 형태로 표현 
비트맵은 가로 세로 크기가 있는 영여겡 픽셀이라고 부르는 점을 찍어서 그링르 표현 
각 픽셀은 픽셀값이라 부르는 강도를 가지고 있음 
1-48

그렇다면 컬러이미지는 어떻게 표현할까?  
빛의 3원색인 빨강, 파랑, 초록의 색상의 강도를 나눠서 표현함  
채널이라고 부르는 동일한 크기의 영역 각각에 빨강 파랑 초록의 강도를 0ㅇ서 255까지 표현함 

1-49

따라서 이미지의 크기는 **가로** * **세로** * **채널 수**로 구할 수 있음 

1-50

이미지 데이터를 Fully Connected Network로 학습하려면?  

데이터를 일자로 쭉펴서 픽셀 하나하나의 값을 가지고 학습을 전부해야함  

1-51

가로 세로 픽셀이 각각 10 by 10인 컬러 이미지의 경우에 300픽셀이 300차원의 벡터 x가 됨  
하지만 이렇게 하면 지금첢처럼 이미지가 조금만 복잡해져도 좋은 성능을 ㅐㄴ기 어려움

이미지의 지역적 특성을 반영하지 못함

### 이미지의 지역적 특성이란? 
이미지 내에서 객체나 형태와 같은 특징이 부분적으로 나타나는 것 

예시) 1-52

그런데 이미지는 작은 지역의 특징이고 큰 형태를 만들고 2차원 구조를 만들게 됨 
이것을 FCN로 인식한다는 것은 가중치를 다 따로따로 학습한다는 의미 

인식해야하는 특성에 비해 학습시켜야 하는 가중치가 과도하게많아서 비효율적  

1-53

그런데 어떠한 이미지에 보현적인 특징이 위치마다 다 다르진 않을 것임 즉, 중복이 됨 

이러한 비효율을 개선하기 위해서 지역적 특성을 추출할 수 있는 적당히 작은 고정된 크기로 묶어서 학습하자는것이 CNN의 시작! 

이렇게 묶인 공통적인 지역적 특성을 추출할 수 있는 단위를 **Convolution Filter**라고 함 

## Convolutional Filter
- Kernel이라고도 부름
- 이미지 크기보다 작은 크기의 행렬 
- 각각의 행렬값이 딥러닝의 학습파라미터인 Weight임 
- 이미지에서 Conv Filter 행렬 크기만큼의 영역에 대해 계산을 수행
- 이미지 내의 패턴이나 특징을 효과적으로 인식 
- Convolution Filter 를 이용한 연산을 Convolution 연산이라고 부름 
1-54

이러한 **Convolution 연산**을 포함한 **Convolutinal Layer**로 이루어진 네트워크 구조를 **Convolutional Neural Network(CNN)**라고 함 

그러면 CNN을 어떤 분야에서 많이 사용할까?
1-55

## Convoluional Network 구조 

1-56  
앞으로 배움 


## Convolutional Layer 

: 컨볼루션 연산이 수행되는 레이어 

입력 데이터에 커널이라는 필터를 적용하여 값을 계산 

예시) 3 by 3 크기의 필터가 있다고 하자 
연산을 위해서 이 작은 조각을 입력데이터의 좌상단에 대응시키는것ㅇ로 시작 
입력데이터의 숫자와 필터에 있는 값을 같은 위치에 있는 값과 곱하고 다 더함 

1-57

이렇게 곱한 값들을 다 더한다고 해서 한국어로 합성곱이라고 부르기도 함 

실제로 cnn에서 컨볼ㄹ루션 레이어를 사용할떄에는 입력과 출력의 채널수를 고ㅎ려해야함
입력레이어 r,g,b,처럼 채널이 3개라고 하면 커널으 ㅣ채널도 3개가됨 
따라서 컨볼류션 연산의 최종결과는 채널별로 구한 값을 모두 더하여 계산 

또한 커널 하나에는 최종적으로 더해지는 바이어스 값도 학습됨  

1-58

이러헥 한번의 계산이 끄탄면 한칸식 필터를 옮겨가면서 계산을 해줌 
이걸 Feature Map(특성 맵)이라고도 함 
실제로 이것이 이미지라기 보다는 입력에 각픽셀에 대응되는 특징을 위치정보를 유지한 순서대로 출력함 
1-59

1-60
그리고 여기 커널에 있느 값들은 고정도니게 아니라 나중에 모델이 데잍러ㅡㄹ 통해 학습하는 파라미터(Weight)이며 이미지의 특성을 가장 잘 파악할 수 있는 방향으로 바꾸미

이러한 컨볼류션 필터의 크기를 바꿀 수도 있음 
이것을 커널 크기(Kernel Size)라고 부름
좀 더 넓은 주변부의 정보를 요약하고 싶다면 커널의 크기가 커지면 됨 

1-61 

그리고 지금까지는 커널이 한 칸씩 이동했는데 필터를 몇 칸씩 이동할지 설정할 수도 있음  이걸 스트라이드라고 부름  기본값은 1인데 2가 되면  두 칸씩 이동하게됨 
즉 한칸씩 건너뛰어 계산하게 되므로 출력되는 피쳐맵의 크기가 줄어듬 

1-62

**STRIDE의 직관적 의미**

- Convolution은 주변 정보를 모은다
- Stride로 건너뛰어도, 아예 건너뛴 픽셀은 없다
- Convolution 연산의 복잡도를 줄임 

가장자리의 정보는 상대적으로 덜 반영될 수밖에 없음! 

1-63

이 문제를 해결할 수 있는 방법이 있음 
이미지 가장자리에 임의의 값들을 채워넣어줄 건데 이게 바로 **Padding**이라고 함 

1-64 

보통 이렇게 0으로 채우는 경우가 많음  
가장자리에 padding을 함으로써 입력이미지의 크기 자체가 커지는 효과가 있음
그리고 이미지 가장자리의 정보도 더 반영됨 

1-65  

그렇다면 시각적이미지의 지역적 특성을 추출하는 convolution layer는 어떻게 구성될까?

처음소개에서 외곽선 정보 질감 패턴등 여러가지 시각적 특성을 추출할 수잇다고 언급ㅎㅁ

여러개의 대으오디는 커널들이 필요함 
입력이미지는 커널 수 만큼의 피쳐 맵으로 변환됨
이 한=묶으음 피쳐맵을 추출하는 n개의 커널이 컨볼루셔널 레이어 하나를 구성하는 요소가 됨 




